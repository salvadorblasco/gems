
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Public GEMS API &#8212; gems 0.5 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="GEMS Changelog" href="changelog.html" />
    <link rel="prev" title="Algorithm Details" href="algorithm.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="public-gems-api">
<h1>Public GEMS API<a class="headerlink" href="#public-gems-api" title="Permalink to this headline">¶</a></h1>
<p>The module <code class="xref py py-mod docutils literal notranslate"><span class="pre">gems</span></code> is organised in several submodules.</p>
<ul class="simple">
<li><dl class="first docutils">
<dt><a class="reference internal" href="#module-gems.libio" title="gems.libio"><code class="xref py py-mod docutils literal notranslate"><span class="pre">gems.libio</span></code></a> contains input/output routines. You want to start with this one</dt>
<dd>in order to load the data and pass it to the fitting routines.</dd>
</dl>
</li>
<li><a class="reference internal" href="#module-gems.fit" title="gems.fit"><code class="xref py py-mod docutils literal notranslate"><span class="pre">gems.fit</span></code></a> contains the optimisation routines for fitting the data.</li>
<li><dl class="first docutils">
<dt><a class="reference internal" href="#module-gems.libuk" title="gems.libuk"><code class="xref py py-mod docutils literal notranslate"><span class="pre">gems.libuk</span></code></a> contains all the tools you need to handle the microspeciation</dt>
<dd>information.</dd>
</dl>
</li>
<li><a class="reference internal" href="#module-gems.plotter" title="gems.plotter"><code class="xref py py-mod docutils literal notranslate"><span class="pre">gems.plotter</span></code></a> contains routines for plotting the results obtained</li>
<li><a class="reference internal" href="#module-gems.report" title="gems.report"><code class="xref py py-mod docutils literal notranslate"><span class="pre">gems.report</span></code></a> contains reporting routines</li>
</ul>
<div class="section" id="variable-definition">
<h2>variable definition<a class="headerlink" href="#variable-definition" title="Permalink to this headline">¶</a></h2>
<div class="section" id="free-energy">
<span id="def-free-energy"></span><h3>Free Energy<a class="headerlink" href="#free-energy" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> where the keys are the microstate codified as a tuple of ones and zeros
and the value is a float representing the value of the energy that correspond to
that microstate.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">free_energy</span> <span class="o">=</span> <span class="p">{(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="mf">0.0</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="o">-</span><span class="mf">12.41</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="o">-</span><span class="mf">13.01</span><span class="p">,</span>
    <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="o">-</span><span class="mf">22.14</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="o">-</span><span class="mf">10.43</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="o">-</span><span class="mf">29.13</span><span class="p">,</span>
    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="o">-</span><span class="mf">27.34</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="o">-</span><span class="mf">41.42</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="microstate">
<span id="microstate-definition"></span><h3>Microstate<a class="headerlink" href="#microstate" title="Permalink to this headline">¶</a></h3>
<p>The microstate can be codified either with numbers or letters. A tuple of zeros and
ones of the lenght of the number of protonation centres can define each one of the
microstates. When the centre s:sub:<cite>j</cite> is protonated, a 1 occupies that place in the
tuple, zero otherwise. A given microstate is generally noted as {<em>s</em><sub>j</sub>} which
means the collection of 0s and 1s that represent it, e.g. {0, 1, 0, 1} meaning that
<em>s</em><sub>1</sub> = 0, <em>s</em><sub>2</sub> = 1, <em>s</em><sub>3</sub> = 0, <em>s</em><sub>4</sub> = 1.</p>
</div>
<div class="section" id="microstate-probability">
<span id="def-microstate-probability"></span><h3>Microstate Probability<a class="headerlink" href="#microstate-probability" title="Permalink to this headline">¶</a></h3>
<p>Each microstate has a probability that can be calculated from the free energy.</p>
<div class="math notranslate nohighlight">
\[p(\{s_j\}) = \frac{a_{\mathrm{H}}^n e^{-\beta F(\{s_j\})}}{\sum_{\{s_j\}} a_{\mathrm{H}}^n e^{-\beta F(\{s_j\})}}\]</div>
<p>Internally, this variable is stored as a <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> where the key is a
microstate binary tuple and the value is an iterable (like a 1D array) containing
the values of the microstate probability for each titration point.</p>
</div>
<div class="section" id="macrostate-probability">
<span id="def-macrostate-probability"></span><h3>Macrostate Probability<a class="headerlink" href="#macrostate-probability" title="Permalink to this headline">¶</a></h3>
<p>Each macrostate has a probability that can be calculated according to</p>
<div class="math notranslate nohighlight">
\[P_n(a_H) = \frac{\bar{K_n} a_{\rm H}^n}{\sum_{n=0}^N \bar{K_n} a_{\mathrm{H}}^n}\]</div>
</div>
<div class="section" id="conditional-probability">
<span id="def-conditional-probability"></span><h3>Conditional Probability<a class="headerlink" href="#conditional-probability" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\pi_n(\{s_j\}) = \frac{e^{-\beta F(\{s_j\})}}{\sum_{\{s_j\}} e^{-\beta F(\{s_j\})}}\]</div>
<div class="math notranslate nohighlight">
\[\pi_n(\{s_j\}) = \pi_n({s_j}) P_n(a_H)\]</div>
</div>
<div class="section" id="molecule-symmetry">
<span id="def-molecule-symmetry"></span><h3>Molecule Symmetry<a class="headerlink" href="#molecule-symmetry" title="Permalink to this headline">¶</a></h3>
<p>The symmetry of a molecule can be expressed as a string of letters with a multiplier for
the sites that are equivalent. For example <code class="samp docutils literal notranslate"><span class="pre">A2B</span></code> if the molecule has three
centres, two of which are equivalent; or <code class="samp docutils literal notranslate"><span class="pre">ABC</span></code> if the molecule has three
different centres.</p>
</div>
<div class="section" id="a-matrix">
<span id="def-a-matrix"></span><h3>A Matrix<a class="headerlink" href="#a-matrix" title="Permalink to this headline">¶</a></h3>
<p>The <strong>A</strong> matrix represents the variation in population (rows) when the</p>
</div>
<div class="section" id="b-matrix">
<span id="def-b-matrix"></span><h3>B Matrix<a class="headerlink" href="#b-matrix" title="Permalink to this headline">¶</a></h3>
<p>The <strong>B</strong> matrix represents the variation of the chemical shift (rows) when the
macroscopic protonation degree changes in one unit.</p>
<div class="math notranslate nohighlight">
\[\delta_l - \delta^{(0)}_l = \sum_{n=1}^N B_{ln} P_n(a_H)\]</div>
</div>
<div class="section" id="delta-matrix">
<span id="def-delta-matrix"></span><h3>Delta Matrix<a class="headerlink" href="#delta-matrix" title="Permalink to this headline">¶</a></h3>
<p>The matrix Δ represents the variation of the chemical shift (rows) when the
protonation degree of a particular site (columns) goes from protonated to
unprotonated.</p>
<div class="math notranslate nohighlight">
\[\delta_l - \delta^{(0)}_l = \sum_{m=1} \Delta_{lm} \theta_m\]</div>
</div>
</div>
<div class="section" id="module-gems.libuk">
<span id="libuk-py"></span><h2>libuk.py<a class="headerlink" href="#module-gems.libuk" title="Permalink to this headline">¶</a></h2>
<p>This module contains the basic tools for microconstants. These functions
are loaded by <strong class="program">GEMS</strong> or they can be used in a standalone
python script.</p>
<div class="section" id="microstates-nomenclature">
<h3>Microstates Nomenclature<a class="headerlink" href="#microstates-nomenclature" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference internal" href="#gems.libuk.name_microstate" title="gems.libuk.name_microstate"><code class="xref py py-func docutils literal notranslate"><span class="pre">name_microstate()</span></code></a></li>
<li><a class="reference internal" href="#gems.libuk.name_terms" title="gems.libuk.name_terms"><code class="xref py py-func docutils literal notranslate"><span class="pre">name_terms()</span></code></a></li>
<li><a class="reference internal" href="#gems.libuk.expand_name" title="gems.libuk.expand_name"><code class="xref py py-func docutils literal notranslate"><span class="pre">expand_name()</span></code></a></li>
<li><a class="reference internal" href="#gems.libuk.compact_name" title="gems.libuk.compact_name"><code class="xref py py-func docutils literal notranslate"><span class="pre">compact_name()</span></code></a></li>
<li><a class="reference internal" href="#gems.libuk.molecule_info" title="gems.libuk.molecule_info"><code class="xref py py-func docutils literal notranslate"><span class="pre">molecule_info()</span></code></a></li>
</ul>
</div>
<div class="section" id="functions-for-multiplicity-and-combinatory">
<h3>Functions for Multiplicity and Combinatory<a class="headerlink" href="#functions-for-multiplicity-and-combinatory" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference internal" href="#gems.libuk.order_terms" title="gems.libuk.order_terms"><code class="xref py py-func docutils literal notranslate"><span class="pre">order_terms()</span></code></a></li>
<li><a class="reference internal" href="#gems.libuk.kdeflation" title="gems.libuk.kdeflation"><code class="xref py py-func docutils literal notranslate"><span class="pre">kdeflation()</span></code></a></li>
<li><a class="reference internal" href="#gems.libuk.comb" title="gems.libuk.comb"><code class="xref py py-func docutils literal notranslate"><span class="pre">comb()</span></code></a></li>
<li><code class="xref py py-func docutils literal notranslate"><span class="pre">remainder()</span></code></li>
<li><code class="xref py py-func docutils literal notranslate"><span class="pre">generate_microstep()</span></code></li>
<li><code class="xref py py-func docutils literal notranslate"><span class="pre">state_microsteps()</span></code></li>
<li><code class="xref py py-func docutils literal notranslate"><span class="pre">total_microconsts()</span></code></li>
<li><a class="reference internal" href="#gems.libuk.total_microstates" title="gems.libuk.total_microstates"><code class="xref py py-func docutils literal notranslate"><span class="pre">total_microstates()</span></code></a></li>
<li><code class="xref py py-func docutils literal notranslate"><span class="pre">generate_microstate()</span></code></li>
<li><code class="xref py py-func docutils literal notranslate"><span class="pre">generate_all_microstates()</span></code></li>
<li><code class="xref py py-func docutils literal notranslate"><span class="pre">count_microstate()</span></code></li>
<li><a class="reference internal" href="#gems.libuk.remove_equivalent_states" title="gems.libuk.remove_equivalent_states"><code class="xref py py-func docutils literal notranslate"><span class="pre">remove_equivalent_states()</span></code></a></li>
</ul>
</div>
<div class="section" id="terms-calculations">
<h3>Terms calculations<a class="headerlink" href="#terms-calculations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference internal" href="#gems.libuk.fit_free_energy" title="gems.libuk.fit_free_energy"><code class="xref py py-func docutils literal notranslate"><span class="pre">fit_free_energy()</span></code></a></li>
<li><a class="reference internal" href="#gems.libuk.microstate_probability" title="gems.libuk.microstate_probability"><code class="xref py py-func docutils literal notranslate"><span class="pre">microstate_probability()</span></code></a></li>
<li><a class="reference internal" href="#gems.libuk.macrostate_probability" title="gems.libuk.macrostate_probability"><code class="xref py py-func docutils literal notranslate"><span class="pre">macrostate_probability()</span></code></a></li>
<li><a class="reference internal" href="#gems.libuk.matrix_a" title="gems.libuk.matrix_a"><code class="xref py py-func docutils literal notranslate"><span class="pre">matrix_a()</span></code></a></li>
<li><a class="reference internal" href="#gems.libuk.matrix_b" title="gems.libuk.matrix_b"><code class="xref py py-func docutils literal notranslate"><span class="pre">matrix_b()</span></code></a></li>
<li><a class="reference internal" href="#gems.libuk.conditional_probability2" title="gems.libuk.conditional_probability2"><code class="xref py py-func docutils literal notranslate"><span class="pre">conditional_probability2()</span></code></a></li>
<li><a class="reference internal" href="#gems.libuk.conditional_probability1" title="gems.libuk.conditional_probability1"><code class="xref py py-func docutils literal notranslate"><span class="pre">conditional_probability1()</span></code></a></li>
<li><a class="reference internal" href="#gems.libuk.avg_prtdeg" title="gems.libuk.avg_prtdeg"><code class="xref py py-func docutils literal notranslate"><span class="pre">avg_prtdeg()</span></code></a></li>
<li><a class="reference internal" href="#gems.libuk.microstate_multiplicity" title="gems.libuk.microstate_multiplicity"><code class="xref py py-func docutils literal notranslate"><span class="pre">microstate_multiplicity()</span></code></a></li>
<li><a class="reference internal" href="#gems.libuk.micro_constants2" title="gems.libuk.micro_constants2"><code class="xref py py-func docutils literal notranslate"><span class="pre">micro_constants2()</span></code></a></li>
<li><a class="reference internal" href="#gems.libuk.micro_constants" title="gems.libuk.micro_constants"><code class="xref py py-func docutils literal notranslate"><span class="pre">micro_constants()</span></code></a></li>
<li><a class="reference internal" href="#gems.libuk.error_macro_constants" title="gems.libuk.error_macro_constants"><code class="xref py py-func docutils literal notranslate"><span class="pre">error_macro_constants()</span></code></a></li>
<li><a class="reference internal" href="#gems.libuk.macro_constants" title="gems.libuk.macro_constants"><code class="xref py py-func docutils literal notranslate"><span class="pre">macro_constants()</span></code></a></li>
<li><a class="reference internal" href="#gems.libuk.num_prot_centres" title="gems.libuk.num_prot_centres"><code class="xref py py-func docutils literal notranslate"><span class="pre">num_prot_centres()</span></code></a></li>
</ul>
<dl class="function">
<dt id="gems.libuk.avg_prtdeg">
<code class="descclassname">gems.libuk.</code><code class="descname">avg_prtdeg</code><span class="sig-paren">(</span><em>msprob</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.libuk.avg_prtdeg" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the average protonation degree.</p>
<p>This routine uses eq (6) from Borkovec et al. <a class="reference internal" href="algorithm.html#borkovec2000" id="id1">[Borkovec2000]</a></p>
<div class="math notranslate nohighlight">
\[\theta_m = \frac1N \sum_{\{s_j\}} s_m p(\{s_j\})\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>msprob</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – the <a class="reference internal" href="#def-microstate-probability"><span class="std std-ref">microstate probability</span></a>.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">average protonation degree of each centre.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)">numpy.ndarray</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gems.libuk.comb">
<code class="descclassname">gems.libuk.</code><code class="descname">comb</code><span class="sig-paren">(</span><em>n</em>, <em>k</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.libuk.comb" title="Permalink to this definition">¶</a></dt>
<dd><p>Combinatorial for n elements  and k.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – the number of elements</li>
<li><strong>k</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – the k combination, where <span class="math notranslate nohighlight">\(n &gt;= k\)</span></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">the combinatorial of n and k</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gems.libuk.compact_name">
<code class="descclassname">gems.libuk.</code><code class="descname">compact_name</code><span class="sig-paren">(</span><em>input_name</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.libuk.compact_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Compact a name.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>input_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – an expanded molecule name</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">the compact name with multipliers</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a></td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">compact_name</span><span class="p">(</span><span class="s1">&#39;AAABCC&#39;</span><span class="p">)</span>
<span class="go">A3BC2</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#gems.libuk.expand_name" title="gems.libuk.expand_name"><code class="xref py py-func docutils literal notranslate"><span class="pre">expand_name()</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="gems.libuk.conditional_probability1">
<code class="descclassname">gems.libuk.</code><code class="descname">conditional_probability1</code><span class="sig-paren">(</span><em>micro_prob</em>, <em>macro_prob</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.libuk.conditional_probability1" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the <a class="reference internal" href="#def-conditional-probability"><span class="std std-ref">Conditional Probability</span></a>.</p>
<p>This routine uses eq (7) from Borkovec et al. <a class="reference internal" href="algorithm.html#borkovec2000" id="id2">[Borkovec2000]</a></p>
<div class="math notranslate nohighlight">
\[\pi_n(\{s_j\}) = \pi_n({s_j}) P_n(a_H)\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>micro_prob</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – The <a class="reference internal" href="#def-microstate-probability"><span class="std std-ref">Microstate Probability</span></a>.</li>
<li><strong>macro_prob</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – The
<a class="reference internal" href="#def-macrostate-probability"><span class="std std-ref">Macrostate Probability</span></a>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gems.libuk.conditional_probability2">
<code class="descclassname">gems.libuk.</code><code class="descname">conditional_probability2</code><span class="sig-paren">(</span><em>free_enrg</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.libuk.conditional_probability2" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the <a class="reference internal" href="#def-conditional-probability"><span class="std std-ref">Conditional Probability</span></a> of each <a class="reference internal" href="#microstate-definition"><span class="std std-ref">Microstate</span></a>.</p>
<div class="math notranslate nohighlight">
\[\pi_n(\{s_j\}) = \frac{e^{-\beta F(\{s_j\})}}
                      {\sum_{\{s_j\}}e^{-\beta F(\{s_j\})}
\delta_{n,\sum_js_j}}\]</div>
</dd></dl>

<dl class="function">
<dt id="gems.libuk.error_macro_constants">
<code class="descclassname">gems.libuk.</code><code class="descname">error_macro_constants</code><span class="sig-paren">(</span><em>free_enrg</em>, <em>error_freenrgy</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.libuk.error_macro_constants" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate error in macroconstants.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>free_enrg</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – dict containing the <a class="reference internal" href="#def-free-energy"><span class="std std-ref">Free Energy</span></a> for each microstate.</li>
<li><strong>error_free_enrgy</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – dict containing the free energy for each
microstate.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gems.libuk.expand_name">
<code class="descclassname">gems.libuk.</code><code class="descname">expand_name</code><span class="sig-paren">(</span><em>input_name</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.libuk.expand_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Expand names with multipliers.</p>
<p>When a site has high multiplicity it is more convenient to express it with
a number rather than with repetition (eg. <code class="samp docutils literal notranslate"><span class="pre">A3B2</span></code> instead of
<code class="samp docutils literal notranslate"><span class="pre">AAABB</span></code>. This routine converts the former in the latter.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>input_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – a compact name</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">an expanded name</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a></td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#gems.libuk.compact_name" title="gems.libuk.compact_name"><code class="xref py py-func docutils literal notranslate"><span class="pre">compact_name()</span></code></a></p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">expand_name</span><span class="p">(</span><span class="s1">&#39;A3B3C&#39;</span><span class="p">)</span>
<span class="go">AAABBBC</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expand_name</span><span class="p">(</span><span class="s1">&#39;ABC&#39;</span><span class="p">)</span>
<span class="go">ABC</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="gems.libuk.fit_free_energy">
<code class="descclassname">gems.libuk.</code><code class="descname">fit_free_energy</code><span class="sig-paren">(</span><em>microk</em>, <em>lvl1=None</em>, <em>lvl2=None</em>, <em>error=False</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.libuk.fit_free_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the free energy of a system based on parameters.</p>
<p>The <strong>free energy</strong> of the system is decomposed in first, second and third
order parameters and calculated according to the following equation.</p>
<div class="math notranslate nohighlight">
\[\frac{\beta F(\{s_j\})}{\ln 10} = -\sum_j{p\hat{K}_js_j}
   + \frac1{2!}\sum_{ij}\varepsilon_{ij}s_is_j
   + \frac1{3!}\sum_{ijk}\lambda_{ijk}s_is_js_k\]</div>
</dd></dl>

<dl class="function">
<dt id="gems.libuk.kdeflation">
<code class="descclassname">gems.libuk.</code><code class="descname">kdeflation</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.libuk.kdeflation" title="Permalink to this definition">¶</a></dt>
<dd><p>Statistical distribution of equilibrium constants.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – the number of protonations</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><em>float</em> – the deflation of the constants</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gems.libuk.macro_constants">
<code class="descclassname">gems.libuk.</code><code class="descname">macro_constants</code><span class="sig-paren">(</span><em>free_enrg: dict</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.libuk.macro_constants" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the macro constants from the energy data.</p>
<p>Applies equation below to calculate the macro constants.</p>
<div class="math notranslate nohighlight">
\[\bar{K_n} = \sum_{\{s_j\}} e^{-\beta F(\{s_j\})} \delta_{n,\sum_js_j}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>free_enrg</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – dict containing the free energy for each microstate.</li>
<li><strong>n_protcentr</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The number of protonation centres</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gems.libuk.macrostate_probability">
<code class="descclassname">gems.libuk.</code><code class="descname">macrostate_probability</code><span class="sig-paren">(</span><em>macro_consts</em>, <em>ah</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.libuk.macrostate_probability" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate probability of a macrostate.</p>
<p>Apply the equations (8) and (10) from <a class="reference internal" href="algorithm.html#borkovec2000" id="id3">[Borkovec2000]</a> in order to calculate
the probability of the macrostates.</p>
<div class="math notranslate nohighlight">
\[P_n(a_H) = \frac{\bar{K_n} a_{\rm H}^n}{\sum_{n=0}^N
           \bar{K_n} a_{\mathrm{H}}^n}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>macro_consts</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – An array containing the values
if the macroconstants.</li>
<li><strong>ah</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – The activity of protons.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The probability of the macrostate.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gems.libuk.matrix_a">
<code class="descclassname">gems.libuk.</code><code class="descname">matrix_a</code><span class="sig-paren">(</span><em>cond_prob</em>, <em>n_centres</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.libuk.matrix_a" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute matrix A.</p>
<p>Compute <a class="reference internal" href="#def-a-matrix"><span class="std std-ref">A Matrix</span></a> using the equation</p>
<div class="math notranslate nohighlight">
\[A_{mn} = \sum_{\{s_j\}} s_m \pi_n(\{s_j\}) \delta_{n,\sum_js_j}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cond_prob</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – The <a class="reference internal" href="#def-conditional-probability"><span class="std std-ref">Conditional Probability</span></a> for each
microstate as output by <a class="reference internal" href="#gems.libuk.conditional_probability1" title="gems.libuk.conditional_probability1"><code class="xref py py-func docutils literal notranslate"><span class="pre">conditional_probability1()</span></code></a> or
<a class="reference internal" href="#gems.libuk.conditional_probability2" title="gems.libuk.conditional_probability2"><code class="xref py py-func docutils literal notranslate"><span class="pre">conditional_probability2()</span></code></a>.</li>
<li><strong>n_centres</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The number of protonation centres</li>
<li><strong>n_indepctres</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The number of independent protonation centres.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The A matrix as defined above.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gems.libuk.matrix_b">
<code class="descclassname">gems.libuk.</code><code class="descname">matrix_b</code><span class="sig-paren">(</span><em>macro_prob</em>, <em>shifts</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.libuk.matrix_b" title="Permalink to this definition">¶</a></dt>
<dd><p>Least square solving for the equation below.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>macro_prob</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – </li>
<li><strong>shifts</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – The experimental chemical shifts.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="math notranslate nohighlight">
\[\delta_i = \delta_i^{(0)} + \sum_{m=1}^N B_{ln} P_n(a_{\mathrm{H}})\]</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">As of now, NumPy does not support linear algebra for masked
arrays. Therefore, if a masked array is passed, the linear algebra
routines are not used. Instead, a least square minimisation is
done. The result should be approximately the same and, for most
cases the used will not perceive the difference.</p>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.5.</span></p>
</div>
</dd></dl>

<dl class="function">
<dt id="gems.libuk.micro_constants">
<code class="descclassname">gems.libuk.</code><code class="descname">micro_constants</code><span class="sig-paren">(</span><em>molecule</em>, <em>free_enrg</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.libuk.micro_constants" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the micro constants from the energy data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>molecule</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – The molecule symmetry</li>
<li><strong>free_enrg</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – dict containing the <a class="reference internal" href="#def-free-energy"><span class="std std-ref">Free Energy</span></a> for each microstate.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><dl class="docutils">
<dt>the values of the microconstants for each microstate and</dt>
<dd><p class="first last">microstep.</p>
</dd>
</dl>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gems.libuk.micro_constants2">
<code class="descclassname">gems.libuk.</code><code class="descname">micro_constants2</code><span class="sig-paren">(</span><em>molecule</em>, <em>lvl1</em>, <em>lvl2</em>, <em>lvl3</em>, <em>elvl1=None</em>, <em>elvl2=None</em>, <em>elvl3=None</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.libuk.micro_constants2" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the micro constants from parameters.</p>
<div class="math notranslate nohighlight">
\[{\rm p}\bar{K}_{A\{s_j\}} = {\rm p}\bar{K}_i
-\sum_j{\varepsilon_{ij}s_j}
-frac12 \sum_{jk}{\lambda_{ijk}s_js_k}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>molecule</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – the molecule symmetry</li>
<li><strong>lvl1</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – a 1D array with first order parameters.</li>
<li><strong>lvl2</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – a 2D array with second order parameters.</li>
<li><strong>lvl3</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – a 3D array with third order parameters.</li>
<li><strong>elvl1</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>, optional) – a 1D array with first order
parameter errors.</li>
<li><strong>elvl2</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>, optional) – a 2D array with second order
parameter errors.</li>
<li><strong>elvl3</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>, optional) – a 3D array with third order
parameter errors.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gems.libuk.microstate_multiplicity">
<code class="descclassname">gems.libuk.</code><code class="descname">microstate_multiplicity</code><span class="sig-paren">(</span><em>molecule</em>, <em>microstate</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.libuk.microstate_multiplicity" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the multiplicity of a microstate.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>molecule</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – The molecule symmetry</li>
<li><strong>microstate</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – The string representation of a microstate</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">the multiplicity of the microstate</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The molecule and microstate strings must be expanded.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">microstate_multiplicity</span><span class="p">(</span><span class="s1">&#39;AABC&#39;</span><span class="p">,</span> <span class="s1">&#39;BC&#39;</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">microstate_multiplicity</span><span class="p">(</span><span class="s1">&#39;AABC&#39;</span><span class="p">,</span> <span class="s1">&#39;ABC&#39;</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="gems.libuk.microstate_population">
<code class="descclassname">gems.libuk.</code><code class="descname">microstate_population</code><span class="sig-paren">(</span><em>conditional_probability</em>, <em>molecule</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.libuk.microstate_population" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the population for each microstate.</p>
<p>The population for each microstate is basically computed in the
<a class="reference internal" href="#def-conditional-probability"><span class="std std-ref">Conditional Probability</span></a> variable. However, some microstates
are equivalent. This routine sums all equivalent microstates together and
returns a more sensible result.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>conditional_probability</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – the <a class="reference internal" href="#def-conditional-probability"><span class="std std-ref">Conditional Probability</span></a>.</li>
<li><strong>molecule</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – A string representing the <a class="reference internal" href="#def-molecule-symmetry"><span class="std std-ref">Molecule Symmetry</span></a>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">the microstate population.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gems.libuk.microstate_probability">
<code class="descclassname">gems.libuk.</code><code class="descname">microstate_probability</code><span class="sig-paren">(</span><em>free_energy</em>, <em>ah</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.libuk.microstate_probability" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate microstate probability from the energy data.</p>
<p>The probability of a given microstate is calculates from the free energy
terms according to:</p>
<div class="math notranslate nohighlight">
\[p(\{s_j\}) = \Xi^{-1} a_H^n e^{-\beta F(\{s_j\})}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\Xi = \sum_{\{s_j\}} a_H^n e^{-\beta F(\{s_j\})}\)</span>
and <span class="math notranslate nohighlight">\(n=\sum_js_j\)</span></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>free_energy</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – A dict containing the free energy for each
microstate.</li>
<li><strong>ah</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – The activity of protons.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The microstate probability for each microstate</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gems.libuk.mlstsq">
<code class="descclassname">gems.libuk.</code><code class="descname">mlstsq</code><span class="sig-paren">(</span><em>A</em>, <em>B</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.libuk.mlstsq" title="Permalink to this definition">¶</a></dt>
<dd><p>Linear least squares for masked arrays.</p>
<p>Compute the array <em>x</em> so that <span class="math notranslate nohighlight">\(||Ax - B||\)</span> is mimized.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>A</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – </li>
<li><strong>B</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/maskedarray.baseclass.html#numpy.ma.MaskedArray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ma.MaskedArray</span></code></a>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The result</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.lstsq.html#scipy.linalg.lstsq" title="(in SciPy v1.6.2)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.linalg.lstsq()</span></code></a></p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This function will be removed when NumPy finally supports
masked matrix inversion.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="gems.libuk.molecule_info">
<code class="descclassname">gems.libuk.</code><code class="descname">molecule_info</code><span class="sig-paren">(</span><em>molecule</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.libuk.molecule_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Info given a molecule symmetry.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>molecule</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – A string representing the <a class="reference internal" href="#def-molecule-symmetry"><span class="std std-ref">Molecule Symmetry</span></a>.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">info about the molecule symmetry<ul class="simple">
<li><em>expanded</em> the molecule with multipliers expanded</li>
<li><em>n_params_1</em> the number of first-order parameters</li>
<li><em>n_params_2</em> the number of second-order parameters</li>
<li><em>n_params_3</em> the number of third-order parameters</li>
<li><em>n_protctrs</em> the number of protonation centres</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gems.libuk.name_microstate">
<code class="descclassname">gems.libuk.</code><code class="descname">name_microstate</code><span class="sig-paren">(</span><em>molecule: str</em>, <em>ms: tuple</em><span class="sig-paren">)</span> &#x2192; str<a class="headerlink" href="#gems.libuk.name_microstate" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a numeric microstate, compute the text version of it.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>molecule</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – A string representing the <a class="reference internal" href="#def-molecule-symmetry"><span class="std std-ref">Molecule Symmetry</span></a>.</li>
<li><strong>ms</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><em>tuple</em></a>) – a 0/1 tuple representing the <a class="reference internal" href="#microstate-definition"><span class="std std-ref">microstate</span></a>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">the name of the microstate.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a></p>
</td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">name_microstate</span><span class="p">(</span><span class="s1">&#39;AABC&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">&#39;AC&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">name_microstate</span><span class="p">(</span><span class="s1">&#39;AAB&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="go">&#39;A&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="gems.libuk.name_terms">
<code class="descclassname">gems.libuk.</code><code class="descname">name_terms</code><span class="sig-paren">(</span><em>molecule</em>, <em>level</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.libuk.name_terms" title="Permalink to this definition">¶</a></dt>
<dd><p>Name the terms of the molecule at a given level.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>molecule</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – A string representing the <a class="reference internal" href="#def-molecule-symmetry"><span class="std std-ref">Molecule Symmetry</span></a>.</li>
<li><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – the level (1, 2, or 3) of the parameters</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">the sorted names of the terms</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">name_terms</span><span class="p">(</span><span class="s1">&#39;AABC&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">[&#39;A&#39;, &#39;B&#39;, &#39;C&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">name_terms</span><span class="p">(</span><span class="s1">&#39;AABC&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">[&#39;AA&#39;, &#39;AB&#39;, &#39;AC&#39;, &#39;BC&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">name_terms</span><span class="p">(</span><span class="s1">&#39;AABC&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">[&#39;AAB&#39;, &#39;AAC&#39;, &#39;ABC&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="gems.libuk.num_prot_centres">
<code class="descclassname">gems.libuk.</code><code class="descname">num_prot_centres</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="headerlink" href="#gems.libuk.num_prot_centres" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the number of protonation centres based on dict of data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>) – any type of data where the keys are a tuple
of zeros and nones indicating the microstate.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">the number of protonation centres.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gems.libuk.order_terms">
<code class="descclassname">gems.libuk.</code><code class="descname">order_terms</code><span class="sig-paren">(</span><em>molecule</em>, <em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.libuk.order_terms" title="Permalink to this definition">¶</a></dt>
<dd><p>Return valid combinations of sites of order n.</p>
<p>Given a molecule, n-th order combinations of the sites defined by the
symmetry. Results are sorted.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>molecule</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – a string defining the summetry of the molecule.</li>
<li><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – the order of interactions, usually n=2 or n=3.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">valid n-th order combinations</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gems.libuk.remove_equivalent_states">
<code class="descclassname">gems.libuk.</code><code class="descname">remove_equivalent_states</code><span class="sig-paren">(</span><em>molecule</em>, <em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.libuk.remove_equivalent_states" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove microstates that are equivalent based on molecule symmetry.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>molecule</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – a string representing the molecule symmetry</li>
<li><strong>data</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – any data where the keys are the microsite numerical
representation.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><dl class="docutils">
<dt>The same <em>data</em> but with the entries that are symmetrically</dt>
<dd><p class="first last">equivalente removed.</p>
</dd>
</dl>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gems.libuk.total_microstates">
<code class="descclassname">gems.libuk.</code><code class="descname">total_microstates</code><span class="sig-paren">(</span><em>microstates</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.libuk.total_microstates" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate total number of microstates.</p>
</dd></dl>

</div>
</div>
<div class="section" id="module-gems.report">
<span id="report-py"></span><h2>report.py<a class="headerlink" href="#module-gems.report" title="Permalink to this headline">¶</a></h2>
<p>Routines for printing information from the data fitting.</p>
<p>Public API</p>
<ul class="simple">
<li><a class="reference internal" href="#gems.report.report_molecule" title="gems.report.report_molecule"><code class="xref py py-func docutils literal notranslate"><span class="pre">gems.report.report_molecule()</span></code></a> for printing a report based on the molecule symmetry.</li>
<li><a class="reference internal" href="#gems.report.minimal_report" title="gems.report.minimal_report"><code class="xref py py-func docutils literal notranslate"><span class="pre">gems.report.minimal_report()</span></code></a> for a small report</li>
<li><a class="reference internal" href="#gems.report.print_report" title="gems.report.print_report"><code class="xref py py-func docutils literal notranslate"><span class="pre">gems.report.print_report()</span></code></a> for a full report. It includes the minimal report.</li>
<li><a class="reference internal" href="#gems.report.generate_scheme" title="gems.report.generate_scheme"><code class="xref py py-func docutils literal notranslate"><span class="pre">gems.report.generate_scheme()</span></code></a></li>
</ul>
<p>Auxiliary functions</p>
<ul class="simple">
<li><a class="reference internal" href="#gems.report.section" title="gems.report.section"><code class="xref py py-func docutils literal notranslate"><span class="pre">gems.report.section()</span></code></a></li>
<li><a class="reference internal" href="#gems.report.print_residuals" title="gems.report.print_residuals"><code class="xref py py-func docutils literal notranslate"><span class="pre">gems.report.print_residuals()</span></code></a></li>
<li><a class="reference internal" href="#gems.report.print_nuclei_influence" title="gems.report.print_nuclei_influence"><code class="xref py py-func docutils literal notranslate"><span class="pre">gems.report.print_nuclei_influence()</span></code></a></li>
<li><a class="reference internal" href="#gems.report.print_microstates" title="gems.report.print_microstates"><code class="xref py py-func docutils literal notranslate"><span class="pre">gems.report.print_microstates()</span></code></a></li>
<li><a class="reference internal" href="#gems.report.print_deltamatrix" title="gems.report.print_deltamatrix"><code class="xref py py-func docutils literal notranslate"><span class="pre">gems.report.print_deltamatrix()</span></code></a></li>
<li><a class="reference internal" href="#gems.report.print_correlation" title="gems.report.print_correlation"><code class="xref py py-func docutils literal notranslate"><span class="pre">gems.report.print_correlation()</span></code></a></li>
<li><a class="reference internal" href="#gems.report.print_bmatrix" title="gems.report.print_bmatrix"><code class="xref py py-func docutils literal notranslate"><span class="pre">gems.report.print_bmatrix()</span></code></a></li>
<li><a class="reference internal" href="#gems.report.print_amatrix" title="gems.report.print_amatrix"><code class="xref py py-func docutils literal notranslate"><span class="pre">gems.report.print_amatrix()</span></code></a></li>
<li><a class="reference internal" href="#gems.report.print_array_half" title="gems.report.print_array_half"><code class="xref py py-func docutils literal notranslate"><span class="pre">gems.report.print_array_half()</span></code></a></li>
<li><a class="reference internal" href="#gems.report.print_array_full" title="gems.report.print_array_full"><code class="xref py py-func docutils literal notranslate"><span class="pre">gems.report.print_array_full()</span></code></a></li>
<li><a class="reference internal" href="#gems.report.print_array_sorted" title="gems.report.print_array_sorted"><code class="xref py py-func docutils literal notranslate"><span class="pre">gems.report.print_array_sorted()</span></code></a></li>
<li><a class="reference internal" href="#gems.report.print_parameters" title="gems.report.print_parameters"><code class="xref py py-func docutils literal notranslate"><span class="pre">gems.report.print_parameters()</span></code></a></li>
<li><a class="reference internal" href="#gems.report.print_populations" title="gems.report.print_populations"><code class="xref py py-func docutils literal notranslate"><span class="pre">gems.report.print_populations()</span></code></a></li>
<li><a class="reference internal" href="#gems.report.prefit" title="gems.report.prefit"><code class="xref py py-func docutils literal notranslate"><span class="pre">gems.report.prefit()</span></code></a></li>
</ul>
<dl class="function">
<dt id="gems.report.generate_scheme">
<code class="descclassname">gems.report.</code><code class="descname">generate_scheme</code><span class="sig-paren">(</span><em>molecule</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.report.generate_scheme" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the possible protonation pathways for a given molecule.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>molecule</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – A string representing the expanded molecule symmetry.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="docutils">
<dt>each element is a <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> whose keys are the possible</dt>
<dd>microstates and the values are sets which contain the possible
protonation sites available.</dd>
</dl>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gems</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">generate_scheme</span><span class="p">(</span><span class="s1">&#39;AAB&#39;</span><span class="p">)</span>
<span class="go">[{&#39;&#39;: {&#39;A&#39;, &#39;B&#39;}},</span>
<span class="go"> {&#39;B&#39;: {&#39;A&#39;}, &#39;A&#39;: {&#39;A&#39;, &#39;B&#39;}},</span>
<span class="go"> {&#39;AB&#39;: {&#39;A&#39;}, &#39;AA&#39;: {&#39;B&#39;}},</span>
<span class="go"> {&#39;AAB&#39;: set()}]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="gems.report.minimal_report">
<code class="descclassname">gems.report.</code><code class="descname">minimal_report</code><span class="sig-paren">(</span><em>infodict</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.report.minimal_report" title="Permalink to this definition">¶</a></dt>
<dd><p>Print minimal report.</p>
</dd></dl>

<dl class="function">
<dt id="gems.report.prefit">
<code class="descclassname">gems.report.</code><code class="descname">prefit</code><span class="sig-paren">(</span><em>title</em>, <em>n_points</em>, <em>n_data</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.report.prefit" title="Permalink to this definition">¶</a></dt>
<dd><p>Print initial message.</p>
</dd></dl>

<dl class="function">
<dt id="gems.report.print_amatrix">
<code class="descclassname">gems.report.</code><code class="descname">print_amatrix</code><span class="sig-paren">(</span><em>amatrix</em>, <em>molecule</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.report.print_amatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Print report on <a class="reference internal" href="#def-a-matrix"><span class="std std-ref">A Matrix</span></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>amatrix</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – the A matrix.</li>
<li><strong>molecule</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – A string representing the expanded molecule symmetry.</li>
<li><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – this is ignored</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gems.report.print_array_full">
<code class="descclassname">gems.report.</code><code class="descname">print_array_full</code><span class="sig-paren">(</span><em>array</em>, <em>labels</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.report.print_array_full" title="Permalink to this definition">¶</a></dt>
<dd><p>Print a full array with labels.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>array</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – The array to print</li>
<li><strong>labels</strong> (<em>sequence</em>) – the labels for each row/column of the array</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gems.report.print_array_half">
<code class="descclassname">gems.report.</code><code class="descname">print_array_half</code><span class="sig-paren">(</span><em>array</em>, <em>labels</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.report.print_array_half" title="Permalink to this definition">¶</a></dt>
<dd><p>Print a triangular array with labels.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>array</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – The array to print</li>
<li><strong>labels</strong> (<em>sequence</em>) – the labels for each row/column of the array</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gems.report.print_array_sorted">
<code class="descclassname">gems.report.</code><code class="descname">print_array_sorted</code><span class="sig-paren">(</span><em>array</em>, <em>labels</em>, <em>n=10</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.report.print_array_sorted" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the <em>n</em> highest values of the array.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>array</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – The array to print</li>
<li><strong>labels</strong> (<em>sequence</em>) – the labels for each row/column of the array</li>
<li><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – the number of entries to print</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gems.report.print_bmatrix">
<code class="descclassname">gems.report.</code><code class="descname">print_bmatrix</code><span class="sig-paren">(</span><em>bmatrix</em>, <em>labels</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.report.print_bmatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Print report on <a class="reference internal" href="#def-b-matrix"><span class="std std-ref">B Matrix</span></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>bmatrix</strong> – </li>
<li><strong>labels</strong> – </li>
<li><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – this is ignored</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gems.report.print_correlation">
<code class="descclassname">gems.report.</code><code class="descname">print_correlation</code><span class="sig-paren">(</span><em>corr</em>, <em>molecule</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.report.print_correlation" title="Permalink to this definition">¶</a></dt>
<dd><p>Print information on the correlation matrix.</p>
</dd></dl>

<dl class="function">
<dt id="gems.report.print_deltamatrix">
<code class="descclassname">gems.report.</code><code class="descname">print_deltamatrix</code><span class="sig-paren">(</span><em>dmatrix</em>, <em>delta_span</em>, <em>labels</em>, <em>molecule</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.report.print_deltamatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Print report on <a class="reference internal" href="#def-delta-matrix"><span class="std std-ref">Delta Matrix</span></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dmatrix</strong> – </li>
<li><strong>delta_span</strong> – </li>
<li><strong>labels</strong> – </li>
<li><strong>molecule</strong> – </li>
<li><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – this is ignored</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gems.report.print_macroconstants">
<code class="descclassname">gems.report.</code><code class="descname">print_macroconstants</code><span class="sig-paren">(</span><em>log_macroconstants</em>, <em>error_log_macroconstants</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.report.print_macroconstants" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the macroconstant report.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>log_macroconstants</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – </li>
<li><strong>error_log_macroconstants</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – </li>
<li><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – this is ignored</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gems.report.print_microstates">
<code class="descclassname">gems.report.</code><code class="descname">print_microstates</code><span class="sig-paren">(</span><em>molecule</em>, <em>free_energy</em>, <em>error_free_energy</em>, <em>microconstants</em>, <em>microstate_population</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.report.print_microstates" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the microstates.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>molecule</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – A string representing the expanded molecule symmetry.</li>
<li><strong>free_energy</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – the free energy</li>
<li><strong>error_free_energy</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – the error of the free energy</li>
<li><strong>conditional_probability</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – the conditional microstate probability</li>
<li><strong>microconstants</strong> (<em>iterable</em>) – </li>
<li><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – this is ignored</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gems.report.print_nuclei_influence">
<code class="descclassname">gems.report.</code><code class="descname">print_nuclei_influence</code><span class="sig-paren">(</span><em>xsmooth</em>, <em>ysmooth</em>, <em>labels</em>, <em>centres_unique</em>, <em>centres_occupation</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.report.print_nuclei_influence" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the influence of each nucleus in each protonation step.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>xsmooth</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – </li>
<li><strong>ysmooth</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – </li>
<li><strong>labels</strong> (<em>sequence</em>) – </li>
<li><strong>centres_unique</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – </li>
<li><strong>centers_occupation</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – </li>
<li><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – this is ignored</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gems.report.print_parameters">
<code class="descclassname">gems.report.</code><code class="descname">print_parameters</code><span class="sig-paren">(</span><em>fit1</em>, <em>err1</em>, <em>fit2</em>, <em>err2</em>, <em>fit3</em>, <em>err3</em>, <em>molecule</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.report.print_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Print report about the parameters.</p>
</dd></dl>

<dl class="function">
<dt id="gems.report.print_populations">
<code class="descclassname">gems.report.</code><code class="descname">print_populations</code><span class="sig-paren">(</span><em>n_microcts</em>, <em>n_protctrs</em>, <em>centres_unique</em>, <em>idx_unique</em>, <em>theta</em>, <em>xvalues</em>, <em>macrostate_probability</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.report.print_populations" title="Permalink to this definition">¶</a></dt>
<dd><p>Print information of population analysis.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>n_microcts</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – the number of microconstants in the system</li>
<li><strong>n_protctrs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – the number of protonation centres</li>
<li><strong>centres_unique</strong> – </li>
<li><strong>idx_unique</strong> – </li>
<li><strong>theta</strong> – </li>
<li><strong>xvalues</strong> – </li>
<li><strong>macrostate_probability</strong> – </li>
<li><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – this is ignored</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gems.report.print_report">
<code class="descclassname">gems.report.</code><code class="descname">print_report</code><span class="sig-paren">(</span><em>infodict</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.report.print_report" title="Permalink to this definition">¶</a></dt>
<dd><p>Print report.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>infodict</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – a <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> containing all the infomation.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gems.report.print_residuals">
<code class="descclassname">gems.report.</code><code class="descname">print_residuals</code><span class="sig-paren">(</span><em>residuals</em>, <em>pD</em>, <em>shifts</em>, <em>labels</em>, <em>num=20</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.report.print_residuals" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the part of the report dealing with residuals.</p>
<p>Given a list of residuals produced by the fitting, print the larges
<strong>n</strong> values.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>residuals</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – </li>
<li><strong>pD</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – the x-values</li>
<li><strong>shifts</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – the y-values</li>
<li><strong>labels</strong> (<em>iterable</em>) – the labels associated with y-values</li>
<li><strong>num</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default=20</em>) – the number of residuals to print</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gems.report.print_residuals_uv">
<code class="descclassname">gems.report.</code><code class="descname">print_residuals_uv</code><span class="sig-paren">(</span><em>residuals</em>, <em>pH</em>, <em>absorbance</em>, <em>wavelength</em>, <em>num=20</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.report.print_residuals_uv" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the part of the report dealing with residuals.</p>
<p>Given a list of residuals produced by the fitting, print the larges
<strong>n</strong> values.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>residuals</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – </li>
<li><strong>pD</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – the x-values</li>
<li><strong>shifts</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – the y-values</li>
<li><strong>labels</strong> (<em>iterable</em>) – the labels associated with y-values</li>
<li><strong>num</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default=20</em>) – the number of residuals to print</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gems.report.report_molecule">
<code class="descclassname">gems.report.</code><code class="descname">report_molecule</code><span class="sig-paren">(</span><em>molecule</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.report.report_molecule" title="Permalink to this definition">¶</a></dt>
<dd><p>Print report of a given molecule.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>molecule</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – A string representing the expanded molecule symmetry.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gems.report.section">
<code class="descclassname">gems.report.</code><code class="descname">section</code><span class="sig-paren">(</span><em>text</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.report.section" title="Permalink to this definition">¶</a></dt>
<dd><p>Separate sections.</p>
</dd></dl>

</div>
<div class="section" id="module-gems.fit">
<span id="fit-py"></span><h2>fit.py<a class="headerlink" href="#module-gems.fit" title="Permalink to this headline">¶</a></h2>
<p>All the routines related to fitting.</p>
<p>Public Functions:
* <a class="reference internal" href="#gems.fit.do_fit" title="gems.fit.do_fit"><code class="xref py py-func docutils literal notranslate"><span class="pre">do_fit()</span></code></a>
* <a class="reference internal" href="#gems.fit.calc_error_free_energy" title="gems.fit.calc_error_free_energy"><code class="xref py py-func docutils literal notranslate"><span class="pre">calc_error_free_energy()</span></code></a>
* <a class="reference internal" href="#gems.fit.fit_shifts2" title="gems.fit.fit_shifts2"><code class="xref py py-func docutils literal notranslate"><span class="pre">fit_shifts2()</span></code></a>
* <a class="reference internal" href="#gems.fit.calc_residuals2" title="gems.fit.calc_residuals2"><code class="xref py py-func docutils literal notranslate"><span class="pre">calc_residuals2()</span></code></a>
* <a class="reference internal" href="#gems.fit.fit_shifts" title="gems.fit.fit_shifts"><code class="xref py py-func docutils literal notranslate"><span class="pre">fit_shifts()</span></code></a>
* <a class="reference internal" href="#gems.fit.calc_residuals" title="gems.fit.calc_residuals"><code class="xref py py-func docutils literal notranslate"><span class="pre">calc_residuals()</span></code></a>
* <a class="reference internal" href="#gems.fit.rearrange_parameters" title="gems.fit.rearrange_parameters"><code class="xref py py-func docutils literal notranslate"><span class="pre">rearrange_parameters()</span></code></a>
* <a class="reference internal" href="#gems.fit.arrange_parameters" title="gems.fit.arrange_parameters"><code class="xref py py-func docutils literal notranslate"><span class="pre">arrange_parameters()</span></code></a></p>
<p>Auxiliary Functions:
* <a class="reference internal" href="#gems.fit.postfit" title="gems.fit.postfit"><code class="xref py py-func docutils literal notranslate"><span class="pre">postfit()</span></code></a>
* <a class="reference internal" href="#gems.fit.fobj" title="gems.fit.fobj"><code class="xref py py-func docutils literal notranslate"><span class="pre">fobj()</span></code></a>
* <a class="reference internal" href="#gems.fit.first_term" title="gems.fit.first_term"><code class="xref py py-func docutils literal notranslate"><span class="pre">first_term()</span></code></a>
* <a class="reference internal" href="#gems.fit.build_terms" title="gems.fit.build_terms"><code class="xref py py-func docutils literal notranslate"><span class="pre">build_terms()</span></code></a></p>
<dl class="function">
<dt id="gems.fit.arrange_parameters">
<code class="descclassname">gems.fit.</code><code class="descname">arrange_parameters</code><span class="sig-paren">(</span><em>expmolec</em>, <em>initvals</em>, <em>order=3</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.fit.arrange_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Build the initial parameter array from initial guess.</p>
<p>Construct an initial array filled with zeros and then insert
the given parameters in its proper places, leaving the not given
parameters as zeros. Additional initial values given are ignored.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>expmolec</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – a string defining the expanded symmetry of the
molecule.</li>
<li><strong>initvals</strong> (<em>iterable</em>) – list of initial values</li>
<li><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – the order of interactions (1, 2 or 3)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><dl class="docutils">
<dt>A 1D array with the parameters arranged in</dt>
<dd><p class="first last">the proper order.</p>
</dd>
</dl>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code></a> – if the order parameter is not within 1–3.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gems.fit.aux_fitting1">
<code class="descclassname">gems.fit.</code><code class="descname">aux_fitting1</code><span class="sig-paren">(</span><em>title</em>, <em>pH</em>, <em>yvalues</em>, <em>molecule</em>, <em>ini_vals</em>, <em>order</em>, <em>flag_uv</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.fit.aux_fitting1" title="Permalink to this definition">¶</a></dt>
<dd><p>Auxiliary function for fitting routines.</p>
</dd></dl>

<dl class="function">
<dt id="gems.fit.build_terms">
<code class="descclassname">gems.fit.</code><code class="descname">build_terms</code><span class="sig-paren">(</span><em>molecule</em>, <em>args=None</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.fit.build_terms" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct epsilon and lambda matrices from parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>molecule</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – a string defining the summetry of the molecule.</li>
<li><strong>args</strong> (<em>sequence</em>) – a sequence containing the parameters</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><dl class="docutils">
<dt>the first element is a 2D array containing the binary terms;</dt>
<dd><p class="first last">the second is a 3D array containing the tertiary terms.</p>
</dd>
</dl>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)">tuple</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gems.fit.calc_error_free_energy">
<code class="descclassname">gems.fit.</code><code class="descname">calc_error_free_energy</code><span class="sig-paren">(</span><em>molecule</em>, <em>variance</em>, <em>n_microcts</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.fit.calc_error_free_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the error in free energy.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>molecule</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – the symmetry of the molecule</li>
<li><strong>variance</strong> (<em>sequence</em>) – the variance in the free energy</li>
<li><strong>n_microcts</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – the number of microconstants</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gems.fit.calc_residuals">
<code class="descclassname">gems.fit.</code><code class="descname">calc_residuals</code><span class="sig-paren">(</span><em>free_energy</em>, <em>shifts</em>, <em>proton_activity</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.fit.calc_residuals" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the residuals.</p>
<p>The fitting is done by equation
<span class="math notranslate nohighlight">\(\delta_l = \delta_l^{(0)} + \sum_{n=1}^N B_{ln} P_n (a_H)\)</span>
by fitting the experimental chemical shifts to the calculated
<span class="math notranslate nohighlight">\(P_n(a_H)\)</span></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>free_energy</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>) – the free energy</li>
<li><strong>shifts</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – the chemical shifts</li>
<li><strong>proton_activity</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – the proton activity</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">the residuals</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gems.fit.calc_residuals2">
<code class="descclassname">gems.fit.</code><code class="descname">calc_residuals2</code><span class="sig-paren">(</span><em>free_energy</em>, <em>shifts</em>, <em>proton_activity</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.fit.calc_residuals2" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the residuals.</p>
<p>The fitting is done by equation
<span class="math notranslate nohighlight">\(\delta_l = \delta_l^{(0)} + \sum_{m=1}^N \Delta_{lm} P_n (a_H)\)</span>
by fitting the experimental chemical shifts to the calculated
<span class="math notranslate nohighlight">\(P_n(a_H)\)</span></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>free_energy</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>) – the free energy</li>
<li><strong>shifts</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – the chemical shifts</li>
<li><strong>proton_activity</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – the proton activity</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">the residuals</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gems.fit.do_fit">
<code class="descclassname">gems.fit.</code><code class="descname">do_fit</code><span class="sig-paren">(</span><em>init_vars</em>, <em>order</em>, <em>expmolec</em>, <em>ah</em>, <em>shifts</em>, <em>weights=1.0</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.fit.do_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit data.</p>
<p>Calls <code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.optimization.minimize()</span></code> in order to minimize
<a class="reference internal" href="#gems.fit.fobj" title="gems.fit.fobj"><code class="xref py py-func docutils literal notranslate"><span class="pre">fobj()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>init_vars</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – </li>
<li><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.5: </span>Added option <em>weights</em></p>
</div>
</dd></dl>

<dl class="function">
<dt id="gems.fit.first_term">
<code class="descclassname">gems.fit.</code><code class="descname">first_term</code><span class="sig-paren">(</span><em>molecule</em>, <em>terms</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.fit.first_term" title="Permalink to this definition">¶</a></dt>
<dd><p>Return first term.</p>
</dd></dl>

<dl class="function">
<dt id="gems.fit.fit_shifts">
<code class="descclassname">gems.fit.</code><code class="descname">fit_shifts</code><span class="sig-paren">(</span><em>macro_prob</em>, <em>shifts</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.fit.fit_shifts" title="Permalink to this definition">¶</a></dt>
<dd><p>Return calculated chemical shifts.</p>
<p>The calculated chemical shifts are computed according to the equation
below. The parameter <em>shifts</em> can be a <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ma.ndarray</span></code>; in this
case, the missing values are zeroed.</p>
<div class="math notranslate nohighlight">
\[\delta^{\rm calc} = P^{+}_n(a_{\mathrm{H}}) \cdot
\delta^{\rm exp} \cdot P_n(a_{\mathrm{H}})\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>macro_prob</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – The  macrostate probability.</li>
<li><strong>shifts</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – The experimental chemical shifts.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">the calculated chemical shifts.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gems.fit.fit_shifts2">
<code class="descclassname">gems.fit.</code><code class="descname">fit_shifts2</code><span class="sig-paren">(</span><em>theta</em>, <em>shifts</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.fit.fit_shifts2" title="Permalink to this definition">¶</a></dt>
<dd><p>Return calculated chemical shifts.</p>
<p>The calculated chemical shifts are computed according to the equation
below. The parameter <em>shifts</em> can be a <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ma.ndarray</span></code>; in this
case, the missing values are zeroed.</p>
<div class="math notranslate nohighlight">
\[\delta^{\rm calc} = \theta \cdot
\left(\delta^{\rm exp} \cdot \theta^+\right)\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>macro_prob</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – The  macrostate probability.</li>
<li><strong>shifts</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – The experimental chemical shifts.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">the calculated chemical shifts.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gems.fit.fobj">
<code class="descclassname">gems.fit.</code><code class="descname">fobj</code><span class="sig-paren">(</span><em>x</em>, <em>*args</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.fit.fobj" title="Permalink to this definition">¶</a></dt>
<dd><p>Objective function to be used with <code class="xref py py-func docutils literal notranslate"><span class="pre">minimize()</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – A 1D array with the fitting parameters</li>
<li><strong>args</strong><strong>[</strong><strong>0</strong><strong>]</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – the parameter range to fit (1, 2 or 3).</li>
<li><strong>args</strong><strong>[</strong><strong>1</strong><strong>]</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – the molecule symmetry.</li>
<li><strong>args</strong><strong>[</strong><strong>2</strong><strong>]</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – the activity of protons</li>
<li><strong>args</strong><strong>[</strong><strong>3</strong><strong>]</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – the experimental data where the
titration points are arranged in rows and nuclei are arranged
in columns.</li>
<li><strong>args</strong><strong>[</strong><strong>4</strong><strong>]</strong> (float or <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – the weights to be used for
minimization.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">the sum of the residuals squared.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)">float</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gems.fit.postfit">
<code class="descclassname">gems.fit.</code><code class="descname">postfit</code><span class="sig-paren">(</span><em>retval</em>, <em>smooth_points=100</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.fit.postfit" title="Permalink to this definition">¶</a></dt>
<dd><p>Complete calculations after the fitting has been done.</p>
<p>The input is a <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> with some data (see below). This function
updates the dict with a lot of additional data.</p>
<ul class="simple">
<li>n_nuclei (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>): the number of nuclei</li>
<li>molecule (str): the symmetry of the molecule</li>
<li>n_microcts (int): the number of microconstants in the system</li>
<li>n_protctrs (int): the number of protonation centres</li>
<li>ah (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>):</li>
<li>iterations (int): the number of iterations</li>
<li><dl class="first docutils">
<dt>function_evaluations (int): the number of times the <a class="reference internal" href="#gems.fit.fobj" title="gems.fit.fobj"><code class="xref py py-func docutils literal notranslate"><span class="pre">fobj()</span></code></a> has</dt>
<dd>been evaluated.</dd>
</dl>
</li>
<li>success</li>
<li>message</li>
<li>chisq (float): the final sum of squared residuals</li>
<li>covariance</li>
<li>fit_params1 (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>):</li>
<li>fit_params2 (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>):</li>
<li>fit_params3 (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>):</li>
<li>err_params1 (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>):</li>
<li>err_params2 (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>):</li>
<li>err_params3 (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>):</li>
<li>correlation</li>
<li>free_energy (dict):</li>
<li>error_free_energy</li>
<li>residuals</li>
<li>microstate_probability</li>
<li>theta</li>
<li>conditional_probability</li>
<li>macroconstants</li>
<li>error_macroconstants</li>
<li>macrostate_probability</li>
<li>microstate_population (dict):</li>
<li>bmatrix (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>):</li>
<li>microconstants</li>
<li>centres_unique</li>
<li>idx_unique</li>
<li>amatrix</li>
<li>dmatrix</li>
<li>delta_span</li>
<li>smooth_ah</li>
<li>xsmooth</li>
<li>ysmooth</li>
<li>distribution</li>
<li>centres_occupation</li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>retval</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – a <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> that must contain the following fields
<em>xvalues</em> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>),
<em>yvalues</em> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>),
<em>result</em> (<code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.optimize.OptimizationResult</span></code>),
<em>labels</em> (sequence), <em>molecule</em> (str). This variable is modified
during the call.</li>
<li><strong>smooth_points</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – the number of points that will be used in the
smooth fitting result.</li>
<li><strong>n_nuclei</strong> (<em>*</em>) – The number of nuclei</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gems.fit.rearrange_parameters">
<code class="descclassname">gems.fit.</code><code class="descname">rearrange_parameters</code><span class="sig-paren">(</span><em>param</em>, <em>param_errors</em>, <em>molecule</em>, <em>order</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.fit.rearrange_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Rearrange a flattened array of parameters into order-sorted arrays.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>param</strong> (<em>iterable</em>) – a 1D array containing ordered parameters</li>
<li><strong>param_errors</strong> (<em>iterable</em>) – a 1D array containing ordered parameter errors</li>
<li><strong>molecule</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – A string representing the molecule symmetry</li>
<li><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – A number indicating the interaction order level (1..3)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><dl class="docutils">
<dt>fit_params1, err_params1, fit_params2, err_params2,</dt>
<dd><p class="first last">fit_params3, err_params3</p>
</dd>
</dl>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)">tuple</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gems.fit.spectra_weighting">
<code class="descclassname">gems.fit.</code><code class="descname">spectra_weighting</code><span class="sig-paren">(</span><em>data</em>, <em>weight_param=0.01</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.fit.spectra_weighting" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate automatic spectra weighting.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – </li>
<li><strong>w0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-gems.plotter">
<span id="plotter-py"></span><h2>plotter.py<a class="headerlink" href="#module-gems.plotter" title="Permalink to this headline">¶</a></h2>
<p>Collection of routines for plotting data.</p>
<div class="section" id="plotting-functions-with-pyplot">
<h3>Plotting functions with pyplot<a class="headerlink" href="#plotting-functions-with-pyplot" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference internal" href="#gems.plotter.do_plot" title="gems.plotter.do_plot"><code class="xref py py-func docutils literal notranslate"><span class="pre">do_plot()</span></code></a></li>
<li><a class="reference internal" href="#gems.plotter.plot_fitting" title="gems.plotter.plot_fitting"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_fitting()</span></code></a></li>
</ul>
</div>
<div class="section" id="plotting-functions-in-axes">
<h3>Plotting functions in Axes<a class="headerlink" href="#plotting-functions-in-axes" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference internal" href="#gems.plotter.plot_distribution" title="gems.plotter.plot_distribution"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_distribution()</span></code></a></li>
<li><a class="reference internal" href="#gems.plotter.plot_dshifts" title="gems.plotter.plot_dshifts"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_dshifts()</span></code></a></li>
<li><a class="reference internal" href="#gems.plotter.plot_microconstants" title="gems.plotter.plot_microconstants"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_microconstants()</span></code></a></li>
<li><a class="reference internal" href="#gems.plotter.plot_energies" title="gems.plotter.plot_energies"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_energies()</span></code></a></li>
<li><a class="reference internal" href="#gems.plotter.plot_shifts" title="gems.plotter.plot_shifts"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_shifts()</span></code></a></li>
<li>:func`plot_uvbmatrix`</li>
<li>:func`plot_uv_residuals`</li>
</ul>
</div>
<div class="section" id="auxiliary-plotting-functions">
<h3>Auxiliary plotting functions<a class="headerlink" href="#auxiliary-plotting-functions" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference internal" href="#gems.plotter.point_microconstants" title="gems.plotter.point_microconstants"><code class="xref py py-func docutils literal notranslate"><span class="pre">point_microconstants()</span></code></a></li>
<li><a class="reference internal" href="#gems.plotter.annotate_microconstants" title="gems.plotter.annotate_microconstants"><code class="xref py py-func docutils literal notranslate"><span class="pre">annotate_microconstants()</span></code></a></li>
<li><a class="reference internal" href="#gems.plotter.make_lines" title="gems.plotter.make_lines"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_lines()</span></code></a></li>
</ul>
<dl class="class">
<dt id="gems.plotter.Plotter">
<em class="property">class </em><code class="descclassname">gems.plotter.</code><code class="descname">Plotter</code><span class="sig-paren">(</span><em>master</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.plotter.Plotter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://matplotlib.org/api/backend_tk_api.html#matplotlib.backends.backend_tkagg.FigureCanvasTkAgg" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.backends.backend_tkagg.FigureCanvasTkAgg</span></code></a></p>
<p>Override FigureCanvas.</p>
<dl class="method">
<dt id="gems.plotter.Plotter.clear">
<code class="descname">clear</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gems.plotter.Plotter.clear" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="gems.plotter.annotate_microconstants">
<code class="descclassname">gems.plotter.</code><code class="descname">annotate_microconstants</code><span class="sig-paren">(</span><em>xvalues</em>, <em>yvalues</em>, <em>labels</em>, <em>axes</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.plotter.annotate_microconstants" title="Permalink to this definition">¶</a></dt>
<dd><p>Insert microconstants annotation into graph.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>xvalues</strong> (<em>iterable</em>) – the x values of the label position.</li>
<li><strong>yvalues</strong> (<em>iterable</em>) – the y values of the label position.</li>
<li><strong>labels</strong> (<em>iterable</em>) – the labels</li>
<li><strong>axes</strong> (<a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a>) – the axes to plot into.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gems.plotter.do_plot">
<code class="descclassname">gems.plotter.</code><code class="descname">do_plot</code><span class="sig-paren">(</span><em>infodict</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.plotter.do_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot everything for NMR data.</p>
<p>Pops new windows with the plots for all the information contained in
the dict.</p>
</dd></dl>

<dl class="function">
<dt id="gems.plotter.do_plot_spectra">
<code class="descclassname">gems.plotter.</code><code class="descname">do_plot_spectra</code><span class="sig-paren">(</span><em>infodict</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.plotter.do_plot_spectra" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot everything for spectra.</p>
<p>Pops new windows with the plots for all the information contained in
the dict.</p>
</dd></dl>

<dl class="function">
<dt id="gems.plotter.make_lines">
<code class="descclassname">gems.plotter.</code><code class="descname">make_lines</code><span class="sig-paren">(</span><em>micro_constants</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.plotter.make_lines" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate where to draw the energy levels.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>micro_constants</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – the microconstants</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="docutils">
<dt>the coordinates of the lines to be drawn in the format</dt>
<dd>((x1, y1), (x2, y2))</dd>
</dl>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gems.plotter.plot_distribution">
<code class="descclassname">gems.plotter.</code><code class="descname">plot_distribution</code><span class="sig-paren">(</span><em>axes</em>, <em>xsmooth</em>, <em>distribution</em>, <em>centres_occupation</em>, <em>centres_unique</em>, <em>n_protctrs</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.plotter.plot_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the macrospecies and microspecies distribution.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>axes</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.Axes.axes</span></code>) – the axes to plot into.</li>
<li><strong>xsmooth</strong> – </li>
<li><strong>distribution</strong> – </li>
<li><strong>centres_occupation</strong> – </li>
<li><strong>centres_unique</strong> – </li>
<li><strong>n_protctrs</strong> – </li>
<li><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – Ignored</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#gems.fit.postfit" title="gems.fit.postfit"><code class="xref py py-func docutils literal notranslate"><span class="pre">gems.fit.postfit()</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="gems.plotter.plot_dshifts">
<code class="descclassname">gems.plotter.</code><code class="descname">plot_dshifts</code><span class="sig-paren">(</span><em>axes</em>, <em>lst</em>, <em>llabels</em>, <em>xsmooth</em>, <em>ysmooth</em>, <em>centres_occupation</em>, <em>centres_unique</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.plotter.plot_dshifts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="gems.plotter.plot_energies">
<code class="descclassname">gems.plotter.</code><code class="descname">plot_energies</code><span class="sig-paren">(</span><em>axes</em>, <em>molecule</em>, <em>free_energy</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.plotter.plot_energies" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot energies.</p>
</dd></dl>

<dl class="function">
<dt id="gems.plotter.plot_fitting">
<code class="descclassname">gems.plotter.</code><code class="descname">plot_fitting</code><span class="sig-paren">(</span><em>xvalues</em>, <em>yvalues</em>, <em>xsmooth</em>, <em>ysmooth</em>, <em>distribution</em>, <em>centres_occupation</em>, <em>labels</em>, <em>centres_unique</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.plotter.plot_fitting" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot fitting.</p>
</dd></dl>

<dl class="function">
<dt id="gems.plotter.plot_microconstants">
<code class="descclassname">gems.plotter.</code><code class="descname">plot_microconstants</code><span class="sig-paren">(</span><em>axes</em>, <em>stepwise_macroconstants</em>, <em>molecule</em>, <em>microconstants</em>, <em>n_protctrs</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.plotter.plot_microconstants" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot microconstants.</p>
</dd></dl>

<dl class="function">
<dt id="gems.plotter.plot_shifts">
<code class="descclassname">gems.plotter.</code><code class="descname">plot_shifts</code><span class="sig-paren">(</span><em>axes</em>, <em>lst</em>, <em>llabels</em>, <em>xvalues</em>, <em>yvalues</em>, <em>xsmooth</em>, <em>ysmooth</em>, <em>distribution</em>, <em>centres_occupation</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.plotter.plot_shifts" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot chemical shifts and distribution in background.</p>
</dd></dl>

<dl class="function">
<dt id="gems.plotter.plot_uv_residuals">
<code class="descclassname">gems.plotter.</code><code class="descname">plot_uv_residuals</code><span class="sig-paren">(</span><em>axes</em>, <em>xdim</em>, <em>residuals</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.plotter.plot_uv_residuals" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot residuals.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>axes</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.Axes.axes</span></code>) – the axes to plot into.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gems.plotter.plot_uvbmatrix">
<code class="descclassname">gems.plotter.</code><code class="descname">plot_uvbmatrix</code><span class="sig-paren">(</span><em>axes</em>, <em>wavelength</em>, <em>bmatrix</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.plotter.plot_uvbmatrix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="gems.plotter.point_microconstants">
<code class="descclassname">gems.plotter.</code><code class="descname">point_microconstants</code><span class="sig-paren">(</span><em>molecule</em>, <em>micro_constants</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.plotter.point_microconstants" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate positions for microconstant labels.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>molecule</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – </li>
<li><strong>micro_constants</strong> (<em>iterable</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><dl class="docutils">
<dt>where [0] and [1] are the <em>x</em>  and <em>y</em>  coordinates of the label,</dt>
<dd><p class="first last">and [2] are the labels.</p>
</dd>
</dl>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)">tuple</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
<div class="section" id="module-gems.libio">
<span id="libio-py"></span><h2>libio.py<a class="headerlink" href="#module-gems.libio" title="Permalink to this headline">¶</a></h2>
<p>This module contains the reading/writing and import/export routines.</p>
<p>Import/export fitting data to/from NumPy array
* <a class="reference internal" href="#gems.libio.import_numpy" title="gems.libio.import_numpy"><code class="xref py py-func docutils literal notranslate"><span class="pre">import_numpy()</span></code></a>
* <a class="reference internal" href="#gems.libio.export_numpy" title="gems.libio.export_numpy"><code class="xref py py-func docutils literal notranslate"><span class="pre">export_numpy()</span></code></a></p>
<p>Load data from file
* <a class="reference internal" href="#gems.libio.load_stream" title="gems.libio.load_stream"><code class="xref py py-func docutils literal notranslate"><span class="pre">load_stream()</span></code></a>
* <a class="reference internal" href="#gems.libio.load_spectra_stream" title="gems.libio.load_spectra_stream"><code class="xref py py-func docutils literal notranslate"><span class="pre">load_spectra_stream()</span></code></a>
* <a class="reference internal" href="#gems.libio.load_file_spectra" title="gems.libio.load_file_spectra"><code class="xref py py-func docutils literal notranslate"><span class="pre">load_file_spectra()</span></code></a>
* <a class="reference internal" href="#gems.libio.load_file" title="gems.libio.load_file"><code class="xref py py-func docutils literal notranslate"><span class="pre">load_file()</span></code></a></p>
<p>Auxiliary/Internal functions
* <a class="reference internal" href="#gems.libio.test_modules" title="gems.libio.test_modules"><code class="xref py py-func docutils literal notranslate"><span class="pre">test_modules()</span></code></a>
* <a class="reference internal" href="#gems.libio.print_welcome" title="gems.libio.print_welcome"><code class="xref py py-func docutils literal notranslate"><span class="pre">print_welcome()</span></code></a>
* <a class="reference internal" href="#gems.libio.prune_data" title="gems.libio.prune_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">prune_data()</span></code></a></p>
<dl class="function">
<dt id="gems.libio.export_numpy">
<code class="descclassname">gems.libio.</code><code class="descname">export_numpy</code><span class="sig-paren">(</span><em>filename: str</em>, <em>infodict: dict</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.libio.export_numpy" title="Permalink to this definition">¶</a></dt>
<dd><p>Write all information into NumPy format file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – the file name.</li>
<li><strong>infodict</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>) – all the information (see <a class="reference internal" href="#gems.fit.postfit" title="gems.fit.postfit"><code class="xref py py-func docutils literal notranslate"><span class="pre">gems.fit.postfit()</span></code></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gems.libio.import_numpy">
<code class="descclassname">gems.libio.</code><code class="descname">import_numpy</code><span class="sig-paren">(</span><em>filename: str</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.libio.import_numpy" title="Permalink to this definition">¶</a></dt>
<dd><p>Read information from NumPy format file.</p>
<p>Uses <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.load.html#numpy.load" title="(in NumPy v1.20)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.load()</span></code></a> and then applies some type conversions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – the file to read from.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">the data read</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a></td>
</tr>
</tbody>
</table>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.6.</span></p>
</div>
</dd></dl>

<dl class="function">
<dt id="gems.libio.load_file">
<code class="descclassname">gems.libio.</code><code class="descname">load_file</code><span class="sig-paren">(</span><em>filename: str</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.libio.load_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Open file and load its contents.</p>
<p>A text file containing the data to be fit. See
<a class="reference internal" href="index.html#data-file-format"><span class="std std-ref">Data File Format</span></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – The file to read from</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="docutils">
<dt>title (str), molecule (str), initial values (list of floats),</dt>
<dd>labels (list of strings), pH (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>),
shifts (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>).</dd>
</dl>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)">tuple</a></td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><code class="xref py py-func docutils literal notranslate"><span class="pre">gems.libio.loadstream()</span></code></p>
</div>
</dd></dl>

<dl class="function">
<dt id="gems.libio.load_file_spectra">
<code class="descclassname">gems.libio.</code><code class="descname">load_file_spectra</code><span class="sig-paren">(</span><em>filename: str</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.libio.load_file_spectra" title="Permalink to this definition">¶</a></dt>
<dd><p>Open file containing spectral data and load its contents.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – The file to read from</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="docutils">
<dt>title (str), molecule (str), initial values (list of floats),</dt>
<dd>pH (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>),
wavelength (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>),
absorbances (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>).</dd>
</dl>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)">tuple</a></td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#gems.libio.load_file" title="gems.libio.load_file"><code class="xref py py-func docutils literal notranslate"><span class="pre">load_file()</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="gems.libio.load_spectra_stream">
<code class="descclassname">gems.libio.</code><code class="descname">load_spectra_stream</code><span class="sig-paren">(</span><em>streamio</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.libio.load_spectra_stream" title="Permalink to this definition">¶</a></dt>
<dd><p>Read datastream containing spectral data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>streamio</strong> (<em>StreamIOr</em>) – The data stream</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="docutils">
<dt>title (str), molecule (str), initial values (list of floats),</dt>
<dd>pH (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>),
wavelength (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>),
absorbances (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>).</dd>
</dl>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)">tuple</a></td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#gems.libio.load_file_spectra" title="gems.libio.load_file_spectra"><code class="xref py py-func docutils literal notranslate"><span class="pre">load_file_spectra()</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="gems.libio.load_stream">
<code class="descclassname">gems.libio.</code><code class="descname">load_stream</code><span class="sig-paren">(</span><em>streamio</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.libio.load_stream" title="Permalink to this definition">¶</a></dt>
<dd><p>Load data from data stream.</p>
<p>For details on the file data format, see <a class="reference internal" href="index.html#data-file-format"><span class="std std-ref">Data File Format</span></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>streamio</strong> (<em>file</em>) – The strem to read data from.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="docutils">
<dt>title (str), molecule (str), initial values (list of floats),</dt>
<dd>labels (list of strings), pH (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>),
shifts (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>).</dd>
</dl>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)">tuple</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gems.libio.print_welcome">
<code class="descclassname">gems.libio.</code><code class="descname">print_welcome</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gems.libio.print_welcome" title="Permalink to this definition">¶</a></dt>
<dd><p>Print welcome message.</p>
</dd></dl>

<dl class="function">
<dt id="gems.libio.prune_data">
<code class="descclassname">gems.libio.</code><code class="descname">prune_data</code><span class="sig-paren">(</span><em>array</em>, <em>rows_ignored</em>, <em>cols_ignored</em>, <em>row_labels</em>, <em>col_labels</em><span class="sig-paren">)</span><a class="headerlink" href="#gems.libio.prune_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove unused data from the bulk of data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>array</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – the initial data.</li>
<li><strong>rows_ignored</strong> (<em>sequence</em>) – </li>
<li><strong>cols_ignored</strong> (<em>sequence</em>) – </li>
<li><strong>row_labels</strong> (<em>sequence</em>) – </li>
<li><strong>col_labels</strong> (<em>sequence</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><dl class="docutils">
<dt>item[0] is <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> the pruned data, item[1] and item[2] are</dt>
<dd><p class="first last">the respective row_labels and col_labels pruned.</p>
</dd>
</dl>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)">tuple</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gems.libio.test_modules">
<code class="descclassname">gems.libio.</code><code class="descname">test_modules</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gems.libio.test_modules" title="Permalink to this definition">¶</a></dt>
<dd><p>Test the modules.</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithm.html">Algorithm Details</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Public GEMS API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#variable-definition">variable definition</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#free-energy">Free Energy</a></li>
<li class="toctree-l3"><a class="reference internal" href="#microstate">Microstate</a></li>
<li class="toctree-l3"><a class="reference internal" href="#microstate-probability">Microstate Probability</a></li>
<li class="toctree-l3"><a class="reference internal" href="#macrostate-probability">Macrostate Probability</a></li>
<li class="toctree-l3"><a class="reference internal" href="#conditional-probability">Conditional Probability</a></li>
<li class="toctree-l3"><a class="reference internal" href="#molecule-symmetry">Molecule Symmetry</a></li>
<li class="toctree-l3"><a class="reference internal" href="#a-matrix">A Matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="#b-matrix">B Matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="#delta-matrix">Delta Matrix</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-gems.libuk">libuk.py</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#microstates-nomenclature">Microstates Nomenclature</a></li>
<li class="toctree-l3"><a class="reference internal" href="#functions-for-multiplicity-and-combinatory">Functions for Multiplicity and Combinatory</a></li>
<li class="toctree-l3"><a class="reference internal" href="#terms-calculations">Terms calculations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-gems.report">report.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-gems.fit">fit.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-gems.plotter">plotter.py</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#plotting-functions-with-pyplot">Plotting functions with pyplot</a></li>
<li class="toctree-l3"><a class="reference internal" href="#plotting-functions-in-axes">Plotting functions in Axes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#auxiliary-plotting-functions">Auxiliary plotting functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-gems.libio">libio.py</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">GEMS Changelog</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="algorithm.html" title="previous chapter">Algorithm Details</a></li>
      <li>Next: <a href="changelog.html" title="next chapter">GEMS Changelog</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, Salvador Blasco.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.8</a>
      
      |
      <a href="_sources/api.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>